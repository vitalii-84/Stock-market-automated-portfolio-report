# üìä Automated Stock Portfolio Report

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π –ø—Ä–æ—î–∫—Ç –¥–ª—è —â–æ–¥–µ–Ω–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤–∞—Ä—Ç–æ—Å—Ç—ñ —ñ–Ω–≤–µ—Å—Ç–∏—Ü—ñ–π–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∞–∫—Ü—ñ–π –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Python —Ç–∞ GitHub Actions.

---

## üöÄ –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

- –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∞–∫—Ç—É–∞–ª—å–Ω—ñ –±—ñ—Ä–∂–æ–≤—ñ –¥–∞–Ω—ñ –∑ **Yahoo Finance**
- —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –≤ –ø–æ—Ä—Ç—Ñ–µ–ª—ñ
- –æ–±—á–∏—Å–ª—é—î **–∑–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è (Total Value)**
- –±—É–¥—É—î **–ª—ñ–Ω—ñ–π–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ –¥–∏–Ω–∞–º—ñ–∫–∏ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤**:
  - –¥–ª—è –∫–æ–∂–Ω–æ—ó –∞–∫—Ü—ñ—ó
  - –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–æ—ó –≤–∞—Ä—Ç–æ—Å—Ç—ñ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –∑–±–µ—Ä—ñ–≥–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É —Ñ–∞–π–ª–∏ (`CSV`, `HTML`)
- –Ω–∞–¥—Å–∏–ª–∞—î **Telegram-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è** –ø—Ä–æ –∑–º—ñ–Ω—É –≤–∞—Ä—Ç–æ—Å—Ç—ñ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è **–ø–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º** –±–µ–∑ —Ä—É—á–Ω–æ—ó —É—á–∞—Å—Ç—ñ

---

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è

–ó–∞–ø—É—Å–∫ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ **GitHub Actions**:

- üîÑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –∑–∞ cron-—Ä–æ–∑–∫–ª–∞–¥–æ–º (—â–æ–¥–Ω—è)
- ‚ñ∂Ô∏è –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É —á–µ—Ä–µ–∑ GitHub UI
- ü§ñ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å —É Telegram –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ
- ‚õî –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ–±–º–µ–∂–µ–Ω–∏–π —É —á–∞—Å—ñ (–¥–æ **31.12.2025**)

---

## üìà –ü—Ä–∏–∫–ª–∞–¥ Telegram-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

üìä Total Value: $11,720.35 (+0.123%)


**–ü–æ—è—Å–Ω–µ–Ω–Ω—è:**
- `Total Value` ‚Äî –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –¥—É–∂–∫–∞—Ö ‚Äî –≤—ñ–¥—Å–æ—Ç–∫–æ–≤–∞ –∑–º—ñ–Ω–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –¥–Ω—è

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```text
.
‚îú‚îÄ‚îÄ portfolio_report.py        # –û—Å–Ω–æ–≤–Ω–∏–π Python-—Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ portfolio_report.csv       # CSV-–∑–≤—ñ—Ç –∑ —ñ—Å—Ç–æ—Ä—ñ—î—é Total Value
‚îú‚îÄ‚îÄ portfolio_plot.html        # –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ –¥–∏–Ω–∞–º—ñ–∫–∏
‚îú‚îÄ‚îÄ README.md                  # –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É
‚îî‚îÄ‚îÄ .github/
    ‚îî‚îÄ‚îÄ workflows/
        ‚îî‚îÄ‚îÄ daily_portfolio.yml  # GitHub Actions workflow
```
---

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π

- **Python 3.11**
- **yfinance** ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –±—ñ—Ä–∂–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
- **pandas** ‚Äî –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
- **plotly** ‚Äî –ø–æ–±—É–¥–æ–≤–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
- **Telegram Bot API** ‚Äî —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
- **GitHub Actions** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ç–∞ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–ø—É—Å–∫—ñ–≤

---

## üîê –ë–µ–∑–ø–µ–∫–∞

- —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —î **–ø—Ä–∏–≤–∞—Ç–Ω–∏–º**
- Telegram Bot Token –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ—é —á–∞—Å—Ç–∏–Ω–æ—é
- –¥–ª—è production-—Ä—ñ—à–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ —á–µ—Ä–µ–∑ **GitHub Secrets**

---

## üéØ –ú–µ—Ç–∞ –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ —è–∫:

- –ø—Ä–∏–∫–ª–∞–¥ **end-to-end –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó**
- –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—é —Ä–æ–±–æ—Ç–∏ –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
- **pet-project / portfolio project** –¥–ª—è Data Analyst / Data Engineer
- –æ—Å–Ω–æ–≤—É –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (–∞–ª–µ—Ä—Ç–∏, ML, BI-–¥–∞—à–±–æ—Ä–¥–∏)

---

## üìå –ú–æ–∂–ª–∏–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- –∞–ª–µ—Ä—Ç–∏ –ø—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –ø–æ—Ä–æ–≥–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å
- —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ BI-—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –≤–∞—Ä—Ç–æ—Å—Ç—ñ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –ø–æ—Ä—Ç—Ñ–µ–ª—ñ–≤
- –¥–µ–ø–ª–æ–π —É —Ö–º–∞—Ä—ñ


```text

# ===============================
# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –∑–≤—ñ—Ç–Ω–æ—Å—Ç—ñ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∑ Telegram
# ===============================

import pandas as pd
import yfinance as yf
from datetime import datetime, timedelta
import plotly.express as px
import requests

# ===============================
# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
# ===============================
holdings = {
    'AAPL': 16,
    'TSLA': 15,
    'TEAM': 7,
}

tickers = list(holdings.keys())

# ===============================
# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Telegram –±–æ—Ç–∞
# ===============================
bot_token = "8316612047:AAGRPfyKZyjKg_q3rEWavf2RiO9EBhydHmo"
chat_id = 6241484631  # —Ç–≤—ñ–π chat_id –∑ getUpdates

def send_telegram_message(message: str):
    """
    –ù–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ Telegram
    """
    url = f"https://api.telegram.org/bot{bot_token}/sendMessage"
    payload = {
        "chat_id": chat_id,
        "text": message,
        "parse_mode": "HTML"
    }
    requests.post(url, data=payload)

# ===============================
# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
# ===============================
end_date = datetime.today()
start_date = end_date - timedelta(days=7)  # –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤

data = yf.download(
    tickers,
    start=start_date.strftime('%Y-%m-%d'),
    end=end_date.strftime('%Y-%m-%d'),
    auto_adjust=True  # –æ—Ç—Ä–∏–º—É—î–º–æ —Å–∫–æ—Ä–∏–≥–æ–≤–∞–Ω—ñ —Ü—ñ–Ω–∏
)

if data.empty or 'Close' not in data.columns:
    raise ValueError("–î–∞–Ω—ñ –Ω–µ –±—É–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–∏–∫–µ—Ä–∏ –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞—Ç.")

# ===============================
# –û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö
# ===============================
close_prices = data['Close'].reset_index()

# –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —É long —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞
close_long = pd.melt(
    close_prices,
    id_vars='Date',
    value_vars=tickers,
    var_name='Ticker',
    value_name='Close'
)

# –î–æ–¥–∞—î–º–æ –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
close_long['Position_Value'] = close_long['Close'] * close_long['Ticker'].map(holdings)

# –ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è –ø–æ –¥–∞—Ç–∞—Ö
total_value = close_long.groupby('Date')['Position_Value'].sum().reset_index()
total_value.rename(columns={'Position_Value': 'Total_Value'}, inplace=True)

# –î–æ–¥–∞—î–º–æ Total Value —É long DataFrame –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞
total_long = total_value.copy()
total_long['Ticker'] = 'Total Value'
total_long.rename(columns={'Total_Value': 'Close'}, inplace=True)

plot_df = pd.concat([close_long[['Date','Ticker','Close']], total_long], ignore_index=True)

# ===============================
# –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫–∞
# ===============================
fig = px.line(
    plot_df,
    x='Date',
    y='Close',
    color='Ticker',
    title="–î–∏–Ω–∞–º—ñ–∫–∞ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –ø–æ—Ä—Ç—Ñ–µ–ª—è —Ç–∞ –∞–∫—Ü—ñ–π"
)
fig.update_layout(
    yaxis_title="–í–∞—Ä—Ç—ñ—Å—Ç—å ($)",
    xaxis_title="–î–∞—Ç–∞"
)
fig.write_html("portfolio_plot.html")  # –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≥—Ä–∞—Ñ—ñ–∫ —É —Ñ–∞–π–ª

# ===============================
# –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Å–æ—Ç–∫–æ–≤–æ—ó –∑–º—ñ–Ω–∏ Total Value
# ===============================
if len(total_value) >= 2:
    today_val = total_value['Total_Value'].iloc[-1]
    prev_val = total_value['Total_Value'].iloc[-2]
    change_pct = (today_val - prev_val) / prev_val * 100
else:
    today_val = total_value['Total_Value'].iloc[-1]
    change_pct = 0

# ===============================
# –ù–∞–¥—Å–∏–ª–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É Telegram
# ===============================
message = f"üìä Total Value: ${today_val:,.2f} ({change_pct:+.3f}%)"
send_telegram_message(message)

# ===============================
# –ó–±–µ—Ä—ñ–≥–∞—î–º–æ CSV –∑–≤—ñ—Ç
# ===============================
total_value.to_csv("portfolio_report.csv", index=False)
